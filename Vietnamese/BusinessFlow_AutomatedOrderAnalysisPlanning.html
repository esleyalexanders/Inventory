<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quy Trình: Phân Tích & Lập Kế Hoạch Đơn Hàng Tự Động - Tự Động ERP</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: Arial, Helvetica, sans-serif;
            line-height: 1.6;
            color: #000;
            background: #fff;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        .header {
            border-bottom: 3px solid #000;
            padding-bottom: 20px;
            margin-bottom: 40px;
        }
        .header h1 {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #1a1a1a;
        }
        .header p {
            font-size: 16px;
            color: #666;
        }
        .back-link {
            display: inline-block;
            margin-bottom: 20px;
            color: #2c5aa0;
            text-decoration: none;
            font-size: 14px;
        }
        .back-link:hover {
            text-decoration: underline;
        }
        .section {
            margin-bottom: 40px;
        }
        h2 {
            font-size: 22px;
            font-weight: bold;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #333;
            color: #1a1a1a;
        }
        h3 {
            font-size: 18px;
            font-weight: bold;
            margin: 25px 0 15px 0;
            padding: 12px;
            background: #f5f5f5;
            border-left: 4px solid #666;
        }
        h4 {
            font-size: 16px;
            font-weight: bold;
            margin: 20px 0 10px 0;
            color: #333;
        }
        p {
            margin-bottom: 12px;
            font-size: 14px;
        }
        ul {
            margin: 10px 0 15px 25px;
            font-size: 14px;
        }
        li {
            margin: 8px 0;
        }
        .flowchart-container {
            background: #f8f8f8;
            border: 2px solid #ddd;
            border-radius: 5px;
            padding: 30px;
            margin: 30px 0;
            text-align: center;
            overflow-x: auto;
        }
        .mermaid {
            display: inline-block;
            text-align: left;
        }
        .explanation-box {
            border: 2px solid #666;
            padding: 25px;
            margin: 20px 0;
            background: #f8f8f8;
            border-radius: 5px;
        }
        .step-box {
            background: #fff;
            border: 1px solid #ddd;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #2c5aa0;
        }
        .step-box h4 {
            color: #2c5aa0;
            margin-top: 0;
        }
        .automation-point {
            border-left: 4px solid #28a745;
            padding: 15px 20px;
            margin: 15px 0;
            background: #f1f9f4;
        }
        .automation-point h4 {
            color: #28a745;
            margin-top: 0;
        }
        .code-section {
            margin: 30px 0;
        }
        .code-container {
            background: #2d2d2d;
            border-radius: 5px;
            padding: 0;
            margin: 20px 0;
            position: relative;
        }
        .code-header {
            background: #1a1a1a;
            padding: 10px 20px;
            border-radius: 5px 5px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .code-title {
            color: #fff;
            font-size: 14px;
            font-weight: bold;
        }
        .copy-button {
            background: #2c5aa0;
            color: #fff;
            border: none;
            padding: 6px 15px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
            transition: background 0.3s;
        }
        .copy-button:hover {
            background: #1e3f7a;
        }
        .copy-button.copied {
            background: #28a745;
        }
        pre {
            margin: 0;
            padding: 20px;
            overflow-x: auto;
        }
        code {
            font-family: 'Courier New', monospace;
            font-size: 13px;
            color: #f8f8f2;
            line-height: 1.5;
        }
        .legend {
            background: #fff;
            border: 1px solid #ddd;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        .legend h4 {
            margin-top: 0;
            margin-bottom: 15px;
        }
        .legend-item {
            display: inline-block;
            margin-right: 30px;
            margin-bottom: 10px;
        }
        .legend-color {
            display: inline-block;
            width: 30px;
            height: 20px;
            border-radius: 3px;
            margin-right: 8px;
            vertical-align: middle;
        }
        .color-manual {
            background: #fff3e0;
            border: 2px solid #ef6c00;
        }
        .color-decision {
            background: #ffebee;
            border: 2px solid #c62828;
        }
        .color-system {
            background: #e3f2fd;
            border: 2px solid #1976d2;
        }
        @media print {
            .container {
                max-width: 100%;
            }
            .copy-button {
                display: none;
            }
        }
    </style>
<body>
    <div class="container">
        <!-- Back Link -->
        <a href="index.html" class="back-link">← Quay lại Tổng quan hệ thống</a>
        <!-- Header -->
        <div class="header">
            <h1>Quy Trình Nghiệp Vụ: Phân Tích & Lập Kế Hoạch Đơn Hàng Tự Động</h1>
            <p>Kiểm tra tồn kho thông minh, lập kế hoạch sản xuất và tính toán ngày giao hàng tự động</p>
        </div>

        <!-- Section 1: Visual Flowchart -->
        <div class="section">
            <h2>1. Sơ Đồ Quy Trình</h2>
            <div class="flowchart-container">
                <div class="mermaid">
flowchart TD
    A[Nhận & xác thực đơn hàng] --> B[Hệ thống kiểm tra tồn kho BOM]
    B --> C{Tồn kho BOM đủ?}
    C -- Có --> D[Dành BOM cho đơn hàng]
    D --> E[Kích hoạt giao hàng/xuất hóa đơn]
    C -- Không --> F[Hệ thống kiểm tra bán thành phẩm]
    F --> G{Bán thành phẩm đủ?}
    G -- Có --> H[Lập kế hoạch lắp ráp cuối]
    H --> I[Kích hoạt lệnh sản xuất]
    G -- Không --> J[Hệ thống kiểm tra tồn kho Component]
    J --> K{Có thể sản xuất nội bộ đủ Component đúng hạn?}
    K -- Có --> L[Tự động lập kế hoạch sản xuất nội bộ]
    L --> M[Kích hoạt lệnh sản xuất]
    K -- Không --> N[Hệ thống đề xuất outsourcing]
    N --> O[Tạo RFQ/PO cho vendor]
    O --> P[Vendor xác nhận lead time]
    P --> Q[Hệ thống tính ngày có vật tư]
    Q --> R[Hệ thống tính ngày giao hàng]
    R --> S[Cập nhật kế hoạch & thông báo]
    M --> Q
    I --> Q
                </div>
            </div>
        </div>

        <!-- Section 2: Flow Explanation -->
        <div class="section">
            <h2>2. Giải Thích Sơ Đồ Quy Trình</h2>
            <div class="explanation-box">
                <p>Quy trình lập kế hoạch thông minh này phân tích từng đơn hàng và xác định chiến lược đáp ứng tối ưu. Hệ thống kiểm tra tồn kho nhiều cấp (BOM, bán thành phẩm, Component), ưu tiên sản xuất nội bộ và tự động tạo kế hoạch sản xuất hoặc yêu cầu outsourcing. Ngày có vật tư và ngày giao hàng được tính toán tự động dựa trên lead time và năng lực sản xuất.</p>
            </div>
            <h3>Các Bước Quy Trình</h3>
            <div class="step-box">
                <h4>Bước 1: Nhận Đơn Hàng</h4>
                <p><strong>Hành động:</strong> Nhận và xác thực đơn hàng từ bước trước (Tiếp nhận đơn hàng).</p>
                <p><strong>Hệ thống:</strong> Đơn hàng sẵn sàng cho phân tích lập kế hoạch với dữ liệu khách hàng và BOM đã xác thực.</p>
            </div>
            <div class="step-box">
                <h4>Bước 2: Kiểm Tra Tồn Kho BOM</h4>
                <p><strong>Hành động:</strong> Hệ thống tự động kiểm tra tồn kho thành phẩm (BOM).</p>
                <p><strong>Hệ thống kiểm tra:</strong></p>
                <ul>
                    <li>Số lượng tồn thực tế của BOM</li>
                    <li>Số lượng khả dụng (tồn thực tế trừ đã giữ cho đơn khác)</li>
                    <li>Trạng thái tồn kho theo thời gian thực ở tất cả kho</li>
                </ul>
            </div>
            <div class="step-box">
                <h4>Bước 3: Quyết Định Tồn Kho BOM</h4>
                <p><strong>Quyết định:</strong> Tồn kho BOM có đủ cho đơn này không?</p>
                <p><strong>Nếu Có (Đủ tồn kho):</strong></p>
                <ul>
                    <li>Hệ thống giữ BOM cho đơn này</li>
                    <li>Trạng thái tồn kho chuyển sang "Đã giữ chỗ"</li>
                    <li>Kích hoạt quy trình giao hàng và xuất hóa đơn (đáp ứng nhanh nhất)</li>
                    <li>Đơn hàng có thể giao ngay hoặc theo ngày yêu cầu</li>
                </ul>
                <p><strong>Nếu Không (Thiếu tồn kho):</strong> Chuyển sang kiểm tra bán thành phẩm</p>
            </div>
            <div class="step-box">
                <h4>Bước 4: Kiểm Tra Bán Thành Phẩm</h4>
                <p><strong>Hành động:</strong> Hệ thống kiểm tra tồn kho bán thành phẩm.</p>
                <p><strong>Hệ thống kiểm tra:</strong></p>
                <ul>
                    <li>Bán thành phẩm có thể lắp ráp thành BOM cuối</li>
                    <li>Số lượng khả dụng sau khi trừ cam kết khác</li>
                    <li>Thời gian lắp ráp cần thiết cho sản xuất cuối</li>
                </ul>
            </div>
            <div class="step-box">
                <h4>Bước 5: Quyết Định Bán Thành Phẩm</h4>
                <p><strong>Quyết định:</strong> Bán thành phẩm có đủ không?</p>
                <p><strong>Nếu Có (Đủ bán thành phẩm):</strong></p>
                <ul>
                    <li>Hệ thống lập kế hoạch lắp ráp/đóng gói cuối</li>
                    <li>Tạo lệnh sản xuất cho lắp ráp</li>
                    <li>Tính toán thời gian lắp ráp và ngày hoàn thành</li>
                </ul>
                <p><strong>Nếu Không (Thiếu bán thành phẩm):</strong> Chuyển sang kiểm tra Component</p>
            </div>
            <div class="step-box">
                <h4>Bước 6: Kiểm Tra Tồn Kho Component</h4>
                <p><strong>Hành động:</strong> Hệ thống kiểm tra tồn kho Component/nguyên vật liệu.</p>
                <p><strong>Hệ thống kiểm tra:</strong></p>
                <ul>
                    <li>Tất cả Component theo cấu trúc BOM</li>
                    <li>Số lượng khả dụng của từng Component</li>
                    <li>Component đang về (PO chờ nhận)</li>
                </ul>
            </div>
            <div class="step-box">
                <h4>Bước 7: Đánh Giá Khả Năng Sản Xuất Nội Bộ</h4>
                <p><strong>Quyết định:</strong> Có thể sản xuất nội bộ đủ Component đúng hạn không?</p>
                <p><strong>Hệ thống đánh giá:</strong></p>
                <ul>
                    <li>Năng lực sản xuất nội bộ hiện có</li>
                    <li>Thời gian sản xuất từng Component</li>
                    <li>Lịch sản xuất và khối lượng công việc hiện tại</li>
                    <li>Ngày giao hàng khách yêu cầu</li>
                </ul>
                <p><strong>Nếu Có (Nội bộ đáp ứng):</strong></p>
                <ul>
                    <li>Hệ thống tự động lập kế hoạch sản xuất nội bộ</li>
                    <li>Tạo lệnh sản xuất cho Component</li>
                    <li>Phân bổ năng lực và lên lịch sản xuất</li>
                    <li><strong>Ưu tiên:</strong> Luôn ưu tiên sản xuất nội bộ</li>
                </ul>
                <p><strong>Nếu Không (Nội bộ không đáp ứng):</strong> Hệ thống đề xuất outsourcing</p>
            </div>
            <div class="step-box">
                <h4>Bước 8: Đề Xuất Outsourcing</h4>
                <p><strong>Hành động:</strong> Hệ thống tự động đề xuất outsourcing cho vendor.</p>
                <p><strong>Logic hệ thống:</strong></p>
                <ul>
                    <li>Xác định Component cần outsourcing</li>
                    <li>Chọn vendor phù hợp theo năng lực và lead time</li>
                    <li>Tính toán số lượng cần thiết</li>
                    <li>Lưu ý: Component chỉ có thể lấy qua vendor outsourcing (không mua trực tiếp)</li>
                </ul>
            </div>
            <div class="step-box">
                <h4>Bước 9: Tạo RFQ/PO Cho Vendor</h4>
                <p><strong>Hành động:</strong> Hệ thống tạo RFQ (Yêu cầu báo giá) hoặc PO (Đơn đặt hàng) cho vendor.</p>
                <p><strong>Hành động tự động:</strong></p>
                <ul>
                    <li>Tự động điền thông số Component từ master data</li>
                    <li>Tính toán số lượng và ngày giao dự kiến</li>
                    <li>Gửi cho vendor qua portal, API hoặc email</li>
                    <li>Theo dõi trạng thái PO trên hệ thống</li>
                </ul>
            </div>
            <div class="step-box">
                <h4>Bước 10: Vendor Xác Nhận Lead Time</h4>
                <p><strong>Hành động:</strong> Vendor xác nhận lead time.</p>
                <p><strong>Vendor cung cấp:</strong></p>
                <ul>
                    <li>Ngày giao hàng xác nhận</li>
                    <li>Lead time (số ngày/tuần)</li>
                    <li>Bất kỳ điều kiện hoặc ràng buộc đặc biệt nào</li>
                </ul>
                <p><strong>Hệ thống:</strong> Ghi nhận phản hồi vendor và cập nhật dữ liệu lập kế hoạch</p>
            </div>
            <div class="step-box">
                <h4>Bước 11: Tính Ngày Có Vật Tư</h4>
                <p><strong>Hành động:</strong> Hệ thống tính toán khi nào tất cả vật tư sẽ sẵn sàng.</p>
                <p><strong>Logic tính toán:</strong></p>
                <ul>
                    <li>Sản xuất nội bộ: Ngày hoàn thành sản xuất</li>
                    <li>Component outsourcing: Ngày vendor giao hàng</li>
                    <li>Ngày có vật tư = Ngày muộn nhất của tất cả Component</li>
                    <li>Xét tất cả phụ thuộc và lead time</li>
                </ul>
            </div>
            <div class="step-box">
                <h4>Bước 12: Tính Ngày Giao Hàng</h4>
                <p><strong>Hành động:</strong> Hệ thống tính ngày giao hàng cuối cho khách.</p>
                <p><strong>Công thức tính:</strong></p>
                <ul>
                    <li>Ngày giao hàng = Ngày có vật tư + Thời gian sản xuất + Thời gian QC + Thời gian đóng gói + Thời gian vận chuyển</li>
                    <li>Có thêm ngày buffer an toàn</li>
                    <li>Xét ngày nghỉ, cuối tuần, lễ</li>
                </ul>
            </div>
            <div class="step-box">
                <h4>Bước 13: Cập Nhật Kế Hoạch & Thông Báo</h4>
                <p><strong>Hành động:</strong> Hệ thống cập nhật kế hoạch đơn hàng và thông báo cho các bên liên quan.</p>
                <p><strong>Hệ thống cập nhật:</strong></p>
                <ul>
                    <li>Trạng thái đơn hàng với chi tiết kế hoạch sản xuất</li>
                    <li>Ngày có vật tư dự kiến</li>
                    <li>Ngày giao hàng đã tính toán</li>
                </ul>
                <p><strong>Thông báo gửi đến:</strong></p>
                <ul>
                    <li>Sales: Ngày giao hàng để thông báo khách</li>
                    <li>Sản xuất: Lệnh sản xuất và lịch trình</li>
                    <li>Mua hàng: PO và theo dõi vendor</li>
                    <li>Kho: Dự kiến nhận vật tư</li>
                    <li>Khách hàng (nếu cần): Thông báo xác nhận đơn và ngày giao</li>
                </ul>
            </div>
            <h3>Điểm Tự Động Hóa Nổi Bật</h3>
            <div class="automation-point">
                <h4>✓ Kiểm Tra Tồn Kho Đa Cấp Thời Gian Thực</h4>
                <p>Hệ thống tự động kiểm tra BOM → Bán thành phẩm → Component liên tục, tìm đường đáp ứng nhanh nhất mà không cần tra cứu thủ công.</p>
            </div>
            <div class="automation-point">
                <h4>✓ Quyết Định Thông Minh Nội Bộ/Outsourcing</h4>
                <p>Hệ thống ưu tiên sản xuất nội bộ, chỉ đề xuất outsourcing khi thiếu năng lực hoặc thời gian. Quyết định dựa trên dữ liệu thực tế về năng lực và lead time.</p>
            </div>
            <div class="automation-point">
                <h4>✓ Tự Động Tạo Kế Hoạch Sản Xuất</h4>
                <p>Lệnh sản xuất nội bộ được tạo tự động với số lượng, lịch trình và phân bổ vật tư chính xác - không cần lập kế hoạch thủ công.</p>
            </div>
            <div class="automation-point">
                <h4>✓ Tự Động Tạo RFQ/PO Cho Vendor</h4>
                <p>Khi cần outsourcing, RFQ và PO được tạo tự động với đầy đủ thông số và gửi cho vendor qua kênh số hóa.</p>
            </div>
            <div class="automation-point">
                <h4>✓ Tự Động Tính Ngày</h4>
                <p>Ngày có vật tư và ngày giao hàng được tính tự động, xét đủ lead time, thời gian sản xuất và các phụ thuộc - cam kết chính xác với khách hàng.</p>
            </div>
            <div class="automation-point">
                <h4>✓ Thông Báo Tự Động Cho Các Bên Liên Quan</h4>
                <p>Tất cả bộ phận liên quan nhận thông báo tự động với thông tin cần thiết - sales nhận ngày giao, sản xuất nhận lệnh, mua hàng nhận PO.</p>
            </div>
        </div>

        <!-- Section 3: Mermaid Code -->
        <div class="section code-section">
            <h2>3. Mã Mermaid Sơ Đồ Quy Trình</h2>
            <p>Sao chép đoạn mã dưới đây để sử dụng sơ đồ này trong tài liệu hoặc công cụ hỗ trợ Mermaid.</p>
            <div class="code-container">
                <div class="code-header">
                    <span class="code-title">Mã sơ đồ Mermaid</span>
                    <button class="copy-button" onclick="copyCode()">Sao chép mã</button>
                </div>
                <pre><code id="mermaid-code">flowchart TD
    A[Nhận & xác thực đơn hàng] --> B[Hệ thống kiểm tra tồn kho BOM]
    B --> C{Tồn kho BOM đủ?}
    C -- Có --> D[Dành BOM cho đơn hàng]
    D --> E[Kích hoạt giao hàng/xuất hóa đơn]
    C -- Không --> F[Hệ thống kiểm tra bán thành phẩm]
    F --> G{Bán thành phẩm đủ?}
    G -- Có --> H[Lập kế hoạch lắp ráp cuối]
    H --> I[Kích hoạt lệnh sản xuất]
    G -- Không --> J[Hệ thống kiểm tra tồn kho Component]
    J --> K{Có thể sản xuất nội bộ đủ Component đúng hạn?}
    K -- Có --> L[Tự động lập kế hoạch sản xuất nội bộ]
    L --> M[Kích hoạt lệnh sản xuất]
    K -- Không --> N[Hệ thống đề xuất outsourcing]
    N --> O[Tạo RFQ/PO cho vendor]
    O --> P[Vendor xác nhận lead time]
    P --> Q[Hệ thống tính ngày có vật tư]
    Q --> R[Hệ thống tính ngày giao hàng]
    R --> S[Cập nhật kế hoạch & thông báo]
    M --> Q
    I --> Q</code></pre>
            </div>
        </div>

        <!-- Footer -->
        <div style="margin-top: 60px; padding-top: 20px; border-top: 2px solid #333; text-align: center; color: #666; font-size: 12px;">
            <p>ERP Automation System - Business Flow Documentation</p>
            <p>Generated: October 2025</p>
        </div>
    </div>

    <script>
        // Initialize Mermaid
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            }
        });

        // Copy code function
        function copyCode() {
            const code = document.getElementById('mermaid-code').textContent;
            const button = document.querySelector('.copy-button');
            
            navigator.clipboard.writeText(code).then(function() {
                button.textContent = 'Đã sao chép!';
                button.classList.add('copied');
                
                setTimeout(function() {
                    button.textContent = 'Sao chép mã';
                    button.classList.remove('copied');
                }, 2000);
            }).catch(function(err) {
                console.error('Không thể sao chép: ', err);
            });
        }
    </script>
</body>
</html>

